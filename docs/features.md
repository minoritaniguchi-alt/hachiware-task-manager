# 機能仕様書

> ハチワレのタスク帳 — Features Document
> 最終更新: 2026-02-18

---

## 1. 解決する課題

### スプレッドシート管理の問題点

| 問題 | 詳細 | 本アプリでの解決策 |
|-----|------|----------------|
| 固定枠の圧迫 | カラム幅・行高が固定で情報が見づらい | カード型 UI で柔軟なレイアウト |
| Done タスクの埋没 | 完了済みが混在してアクティブタスクが見えにくい | Done を自動で「思い出アーカイブ」へ格納 |
| ステータス視認性 | セルの色塗りが手間・見づらい | カラーバッジで一目でわかる |
| 定型業務の管理 | ルーチンと臨時が混在 | ダッシュボードで分離 |
| リロードで消える | ブラウザメモ等は揮発 | localStorage による永続化 |

---

## 2. 機能一覧

### 2-1. タスク管理（CRUD）

#### タスク追加
- フォームにタイトルを入力して「追加」ボタン or Enter で追加
- フォーカス時に詳細入力欄が展開（アニメーション付き）
  - **メモ**: 自由テキスト（任意）
  - **ステータス**: Doing / Review / Pause / Waiting / Done から選択（デフォルト: Doing）
  - **優先度**: 高 / 中 / 低（デフォルト: 中）
  - **期限日**: date ピッカーで選択（任意）
- 追加成功時にトースト通知「がんばろ🐱」等を表示

#### タスク編集（ステータス変更）
- StatusBadge をクリックするとドロップダウンが開く
- 5種類のステータスから選択可能
- Done に変更すると `completedAt` が記録され、自動的にアーカイブへ移動

#### タスク削除
- 各タスク行をホバーするとゴミ箱アイコンが表示
- クリックで即削除（確認ダイアログなし）

---

### 2-2. タスク自動整理アルゴリズム

#### Done タスクの自動アーカイブ

```
ステータスを Done に変更
    │
    ▼
completedAt = new Date().toISOString() をセット
    │
    ▼
tasks 配列を再計算（React レンダリング）
    │
    ▼
activeTasks = tasks.filter(t => t.status !== 'done')
doneTasks   = tasks.filter(t => t.status === 'done')
              .sort((a, b) => completedAt の新しい順)
    │
    ▼
activeTasks → 「やること」セクションに表示
doneTasks   → 「思い出アーカイブ」に折りたたまれて表示
```

#### アーカイブからの復元

- Done タスクをホバーすると「↩ リストに戻す」アイコンが表示
- クリックで `status: 'doing'`, `completedAt: null` に戻す
- トースト「リストに戻したよ🐱」を表示

---

### 2-3. ダッシュボード機能

3つのカテゴリカードで定型・予定業務を管理する。

| カード | ID | 用途 |
|-------|-----|------|
| ルーチン業務 🔄 | `routine` | 毎日・毎週の定型作業チェックリスト |
| 臨時対応 ⚡ | `adhoc` | 突発的に発生した依頼・対応メモ |
| 予定 📅 | `schedule` | 会議・締め切りなどのスケジュール |

- 各カードにテキスト入力 + 追加ボタン
- タイトル行クリックで折りたたみ可能
- アイテムごとにホバーで削除ボタン表示
- ダッシュボード全体も折りたたみ可能（「ダッシュボード」見出しをクリック）

---

### 2-4. フィルタリング機能

タスクリスト上部のフィルターボタンで表示ステータスを絞り込む。

- **すべて**: 全アクティブタスクを表示
- **Doing / Review / Pause / Waiting**: 各ステータスのタスクのみ表示
- フィルターボタンには件数バッジを表示

---

### 2-5. 統計表示

ヘッダーに現在の状況を表示（SM サイズ以上）：

- **進行中 N件**: status が `doing` のタスク数
- **今日 N件完了**: `completedAt` が今日の日付の Done タスク数

---

### 2-6. データ永続化

```javascript
// 保存
localStorage.setItem('hachiware-tasks-v1', JSON.stringify(tasks))
localStorage.setItem('hachiware-dashboard-v1', JSON.stringify(dashboard))

// 読み込み（初期化時）
const saved = localStorage.getItem('hachiware-tasks-v1')
return saved ? JSON.parse(saved) : []
```

- React の `useEffect` が `tasks` / `dashboard` の変更を検知して自動保存
- 初期化は `useState` のイニシャライザ関数で行い、パースエラー時は空配列にフォールバック

---

### 2-7. トースト通知

| トリガー | メッセージ候補 |
|---------|-------------|
| タスク追加 | 「がんばろ🐱」「いってみよう✨」「ファイト💪」 |
| Done に変更 | 「えらい！💙」「すごい！🎉」「やったね✨」「完璧！🐱」「えっらーい！💙」 |
| アーカイブから復元 | 「リストに戻したよ🐱」 |

- ランダムで選択して表示
- 2.5秒後に自動消去

---

## 3. 実装対象外（意図的な除外）

| 機能 | 除外理由 |
|-----|---------|
| ドラッグ&ドロップ並び替え | 初版スコープ外（今後の拡張で `@dnd-kit` 導入予定） |
| タスク編集モーダル | タイトル直接編集は現バージョン対象外 |
| 検索機能 | タスク数が少ない間は不要と判断 |
| 複数ユーザー対応 | localStorage のみのため単一ユーザー前提 |
| タグ・カテゴリ | 今後の拡張対象 |
